# DiskAudit Internals

This document describes the internal design of the disk audit package.  YARD documentation can be generated by running "yard" in the top-level directory.  This document gives a conceptual overview of the main data structures and so on.

## Project Layout

The package layout, aside from standard packaging files, looks like:

```
disk_space_audit
  bin
    bioinfDiskAudit -- main program
  data
    diskAudit
      configuration.yaml -- default configuration file
      logreport.html.erb -- template for HTML logs report
      logreport.txt.erb -- template for plain text logs report
      mailreport.txt.erb -- template for email report
      report.css -- CSS for the HTML report
      report.html.erb -- template for HTML main report
      report.txt.erb -- template for plain text main report
      sorttable.js -- javascript for sortable tables
  lib
    diskAudit.rb -- main class "DiskAudit"
    diskAudit
      auditData.rb -- stores accumulating audit data
      configuration.rb -- configuration data, loaded from YAML file
      constants.rb -- constants used throughout, including package version
      friendlyNumber.rb -- utility for formatting human-readable numbers
      logs.rb -- stores and formats logs (broken links, inaccessible directories)
      pathData.rb -- stores size of directories on a path, determines when to report a "larger" path element
      runInfo.rb -- collects info about the run environment: host, start time, end time, partition size, quota (if applicable), etc.
  test
    test code for various classes
```

## Main Data Structures

The "dump" stage runs on a (possibly remote) partition, producing a data structure which is serialized and sent back to the invoking host.  The "AuditData" class includes:
